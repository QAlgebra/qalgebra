

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Symbolic Algebra &mdash; QAlgebra 2.0.0-dev (9e582ed) documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="_static/mycss.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script src="_static/doctr-versions-menu.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"extensions": ["tex2jax.js"], "jax": ["input/TeX", "output/SVG"], "TeX": {"extensions": ["AMSmath.js", "AMSsymbols.js"], "Macros": {"tr": ["{\\operatorname{tr}}", 0], "Tr": ["{\\operatorname{tr}}", 0], "diag": ["{\\operatorname{diag}}", 0], "abs": ["{\\operatorname{abs}}", 0], "pop": ["{\\operatorname{pop}}", 0], "SLH": ["{\\operatorname{SLH}}", 0], "aux": ["{\\text{aux}}", 0], "opt": ["{\\text{opt}}", 0], "tgt": ["{\\text{tgt}}", 0], "init": ["{\\text{init}}", 0], "lab": ["{\\text{lab}}", 0], "rwa": ["{\\text{rwa}}", 0], "fwhm": ["{\\text{fwhm}}", 0], "bra": ["{\\langle#1\\vert}", 1], "ket": ["{\\vert#1\\rangle}", 1], "Bra": ["{\\left\\langle#1\\right\\vert}", 1], "Braket": ["{\\left\\langle #1\\vphantom{#2} \\mid #2\\vphantom{#1}\\right\\rangle}", 2], "Ket": ["{\\left\\vert#1\\right\\rangle}", 1], "mat": ["{\\mathbf{#1}}", 1], "op": ["{\\hat{#1}}", 1], "Op": ["{\\hat{#1}}", 1], "dd": ["{\\,\\text{d}}", 0], "daggered": ["{^{\\dagger}}", 0], "transposed": ["{^{\\text{T}}}", 0], "Liouville": ["{\\mathcal{L}}", 0], "DynMap": ["{\\mathcal{E}}", 0], "identity": ["{\\mathbf{1}}", 0], "Norm": ["{\\lVert#1\\rVert}", 1], "Abs": ["{\\left\\vert#1\\right\\vert}", 1], "avg": ["{\\langle#1\\rangle}", 1], "Avg": ["{\\left\\langle#1\\right\\rangle}", 1], "AbsSq": ["{\\left\\vert#1\\right\\vert^2}", 1], "Re": ["{\\operatorname{Re}}", 0], "Im": ["{\\operatorname{Im}}", 0], "Real": ["{\\mathbb{R}}", 0], "Complex": ["{\\mathbb{C}}", 0], "Integer": ["{\\mathbb{N}}", 0]}}, "tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Printing System" href="printing.html" />
    <link rel="prev" title="QAlgebra" href="readme.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> QAlgebra
          

          
          </a>

          
            
            
              <div class="version">
                2.0.0-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="readme.html">Installation &amp; Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Quantum Algebra</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Symbolic Algebra</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#expressions-and-operations">Expressions and Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#defining-operation-subclasses">Defining <code class="docutils literal notranslate"><span class="pre">Operation</span></code> subclasses</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pattern-matching">Pattern matching</a></li>
<li class="toctree-l3"><a class="reference internal" href="#algebraic-manipulations">Algebraic Manipulations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id2">Hilbert Space Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="#operator-algebra">Operator Algebra</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#state-ket-algebra">State (Ket-) Algebra</a></li>
<li class="toctree-l2"><a class="reference internal" href="#super-operator-algebra">Super-Operator Algebra</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="printing.html">The Printing System</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="library_structure.html">Library Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="API/qalgebra.html">API of the QAlgebra package</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QAlgebra</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          





















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Symbolic Algebra</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="symbolic-algebra">
<span id="id1"></span><h1>Symbolic Algebra<a class="headerlink" href="#symbolic-algebra" title="Permalink to this headline">¬∂</a></h1>
<div class="section" id="expressions-and-operations">
<span id="abstract-algebra"></span><h2>Expressions and Operations<a class="headerlink" href="#expressions-and-operations" title="Permalink to this headline">¬∂</a></h2>
<p>QAlgebra includes a rich (and extensible) symbolic algebra system for quantum
mechanics. The foundation of the symbolic algebra are the
<a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression" title="qalgebra.core.abstract_algebra.Expression"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expression</span></code></a> class and its subclass <a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Operation" title="qalgebra.core.abstract_algebra.Operation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operation</span></code></a>.</p>
<p>A general algebraic expression has a tree structure. The branches of the tree
are operations; their children are the operands. The leaves of the tree are
scalars or ‚Äúatomic‚Äù expressions, where ‚Äúatomic‚Äù means <em>not</em> an object of type
<a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Operation" title="qalgebra.core.abstract_algebra.Operation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operation</span></code></a> (e.g., a symbol)</p>
<p>For example, the <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.KetPlus" title="qalgebra.core.state_algebra.KetPlus"><code class="xref py py-class docutils literal notranslate"><span class="pre">KetPlus</span></code></a> operation
defines the sum of Hilbert space vectors, represented as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">KetPlus</span><span class="p">(</span><span class="n">psi1</span><span class="p">,</span> <span class="n">psi2</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">psiN</span><span class="p">)</span>
</pre></div>
</div>
<p>All operations follow this pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Head</span><span class="p">(</span><span class="n">op1</span><span class="p">,</span> <span class="n">op1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">opN</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">Head</span></code> is a subclass of <a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Operation" title="qalgebra.core.abstract_algebra.Operation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Operation</span></code></a> and <code class="docutils literal notranslate"><span class="pre">op1</span> <span class="pre">..</span> <span class="pre">opN</span></code> are the
operands, which may be other operations, scalars, or atomic
<a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression" title="qalgebra.core.abstract_algebra.Expression"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expression</span></code></a> objects.</p>
<p>Note that all expressions (inluding operations) can have associated
<em>arguments</em>. For example <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.KetSymbol" title="qalgebra.core.state_algebra.KetSymbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">KetSymbol</span></code></a> takes <cite>label</cite> as an argument, and
the Hilbert space displacement operator <a class="reference internal" href="API/qalgebra.library.fock_operators.html#qalgebra.library.fock_operators.Displace" title="qalgebra.library.fock_operators.Displace"><code class="xref py py-class docutils literal notranslate"><span class="pre">Displace</span></code></a> takes a
displacement amplitude as an argument. To avoid confusion between operands and
arguments, operations are required to take their operands as positional
arguments, and possible additional arguments as keyword arguments.</p>
<p>Expressions should generally not be instantiated directly, but through their
<a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression.create" title="qalgebra.core.abstract_algebra.Expression.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a> method allowing for simplifications. This is true
both for operations and atomic expressions. For example, instantiating
<a class="reference internal" href="API/qalgebra.library.fock_operators.html#qalgebra.library.fock_operators.Displace" title="qalgebra.library.fock_operators.Displace"><code class="xref py py-class docutils literal notranslate"><span class="pre">Displace</span></code></a> with <code class="docutils literal notranslate"><span class="pre">alpha=0</span></code> results in an <a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.IdentityOperator" title="qalgebra.core.operator_algebra.IdentityOperator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IdentityOperator</span></code></a>
(unlike direct instantiation, the create method of any class may or may not
return an instance of the same class). For operations, the <cite>create</cite> method
handles the application of algebraic rules such as associativity (translating
e.g. <code class="docutils literal notranslate"><span class="pre">KetPlus(psi1,</span> <span class="pre">KetPlus(psi2,</span> <span class="pre">psi3))</span></code> into <code class="docutils literal notranslate"><span class="pre">KetPlus(psi1,</span> <span class="pre">psi2,</span> <span class="pre">psi3)</span></code>)</p>
<p>Many operations are associated with infix operators, e.g.  a <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.KetPlus" title="qalgebra.core.state_algebra.KetPlus"><code class="xref py py-class docutils literal notranslate"><span class="pre">KetPlus</span></code></a>
instance is automatically created if two instances of <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.KetSymbol" title="qalgebra.core.state_algebra.KetSymbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">KetSymbol</span></code></a> are
added with <code class="docutils literal notranslate"><span class="pre">+</span></code>. In this case, the <a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression.create" title="qalgebra.core.abstract_algebra.Expression.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a> method is used
automatically.</p>
<p>Expressions and Operations are considered immutable: any change to the
expression tree (e.g. an algebraic simplification) generates a new expression.</p>
<div class="section" id="defining-operation-subclasses">
<h3>Defining <code class="docutils literal notranslate"><span class="pre">Operation</span></code> subclasses<a class="headerlink" href="#defining-operation-subclasses" title="Permalink to this headline">¬∂</a></h3>
<p>When extending an algebra with new operations, it is essential to define the
expression rewriting (‚Äúsimplification‚Äù) rules that govern how new expressions
are instantiated. To this end, the <code class="docutils literal notranslate"><span class="pre">_simplification</span></code> class attribute of an
<a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression" title="qalgebra.core.abstract_algebra.Expression"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expression</span></code></a> subclass must be defined.  This attribute contains a list
of callables. Each of these callables takes three parameters (the class, the
list <code class="docutils literal notranslate"><span class="pre">args</span></code> of positional arguments given to <a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression.create" title="qalgebra.core.abstract_algebra.Expression.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a> and
a dictionary <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> of keyword arguments given to
<a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression.create" title="qalgebra.core.abstract_algebra.Expression.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a>) and return either a tuple of new <code class="docutils literal notranslate"><span class="pre">args</span></code> and
<code class="docutils literal notranslate"><span class="pre">kwargs</span></code> (which are then handed to the next callable), or an
<a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression" title="qalgebra.core.abstract_algebra.Expression"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expression</span></code></a> (which is directly returned as the result of the call to
<a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression.create" title="qalgebra.core.abstract_algebra.Expression.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Expression.create()</span></code></a>).</p>
<p>Callables such as as <a class="reference internal" href="API/qalgebra.core.algebraic_properties.html#qalgebra.core.algebraic_properties.assoc" title="qalgebra.core.algebraic_properties.assoc"><code class="xref py py-func docutils literal notranslate"><span class="pre">assoc()</span></code></a>, <a class="reference internal" href="API/qalgebra.core.algebraic_properties.html#qalgebra.core.algebraic_properties.idem" title="qalgebra.core.algebraic_properties.idem"><code class="xref py py-func docutils literal notranslate"><span class="pre">idem()</span></code></a>, <a class="reference internal" href="API/qalgebra.core.algebraic_properties.html#qalgebra.core.algebraic_properties.orderby" title="qalgebra.core.algebraic_properties.orderby"><code class="xref py py-func docutils literal notranslate"><span class="pre">orderby()</span></code></a>, and
<a class="reference internal" href="API/qalgebra.core.algebraic_properties.html#qalgebra.core.algebraic_properties.filter_neutral" title="qalgebra.core.algebraic_properties.filter_neutral"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_neutral()</span></code></a> handle common algebraic properties such as associativity
or commutativity. The <a class="reference internal" href="API/qalgebra.core.algebraic_properties.html#qalgebra.core.algebraic_properties.match_replace" title="qalgebra.core.algebraic_properties.match_replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">match_replace()</span></code></a> and <a class="reference internal" href="API/qalgebra.core.algebraic_properties.html#qalgebra.core.algebraic_properties.match_replace_binary" title="qalgebra.core.algebraic_properties.match_replace_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">match_replace_binary()</span></code></a>
callables are central to any more advanced simplification through pattern
matching. They delegate to a list of <a class="reference internal" href="API/qalgebra.pattern_matching.html#qalgebra.pattern_matching.Pattern" title="qalgebra.pattern_matching.Pattern"><code class="xref py py-class docutils literal notranslate"><span class="pre">Patterns</span></code></a> and replacements that are defined
in the <code class="docutils literal notranslate"><span class="pre">_rules</span></code>, respectively <code class="docutils literal notranslate"><span class="pre">_binary_rules</span></code> class attributes of the
<a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression" title="qalgebra.core.abstract_algebra.Expression"><code class="xref py py-class docutils literal notranslate"><span class="pre">Expression</span></code></a> subclass.</p>
<p>The pattern matching rules may temporarily extended or modified using the
<a class="reference internal" href="API/qalgebra.toolbox.core.html#qalgebra.toolbox.core.temporary_rules" title="qalgebra.toolbox.core.temporary_rules"><code class="xref py py-func docutils literal notranslate"><span class="pre">qalgebra.toolbox.core.temporary_rules()</span></code></a> context manager.</p>
</div>
<div class="section" id="pattern-matching">
<h3>Pattern matching<a class="headerlink" href="#pattern-matching" title="Permalink to this headline">¬∂</a></h3>
<p>The application of patterns is central to symbolic algebra. Patterns are
defined and applied using the classed and helper routines in the
<a class="reference internal" href="API/qalgebra.pattern_matching.html#module-qalgebra.pattern_matching" title="qalgebra.pattern_matching"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pattern_matching</span></code></a> module.</p>
<p>There are two main places where pattern matching comes up:</p>
<ul class="simple">
<li><p>automatically, through <a class="reference internal" href="API/qalgebra.core.algebraic_properties.html#qalgebra.core.algebraic_properties.match_replace" title="qalgebra.core.algebraic_properties.match_replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">match_replace()</span></code></a> and <a class="reference internal" href="API/qalgebra.core.algebraic_properties.html#qalgebra.core.algebraic_properties.match_replace_binary" title="qalgebra.core.algebraic_properties.match_replace_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">match_replace_binary()</span></code></a>
simplifications applied inside of <a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression.create" title="qalgebra.core.abstract_algebra.Expression.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Expression.create()</span></code></a>.</p></li>
<li><p>manually, e.g. with <a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression.rebuild" title="qalgebra.core.abstract_algebra.Expression.rebuild"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Expression.rebuild()</span></code></a></p></li>
</ul>
<p>Since inside <a class="reference internal" href="API/qalgebra.core.algebraic_properties.html#qalgebra.core.algebraic_properties.match_replace" title="qalgebra.core.algebraic_properties.match_replace"><code class="xref py py-func docutils literal notranslate"><span class="pre">match_replace()</span></code></a> and
<a class="reference internal" href="API/qalgebra.core.algebraic_properties.html#qalgebra.core.algebraic_properties.match_replace_binary" title="qalgebra.core.algebraic_properties.match_replace_binary"><code class="xref py py-func docutils literal notranslate"><span class="pre">match_replace_binary()</span></code></a>, patterns
are matched against expressions that are not yet instantiated (we call these
<a class="reference internal" href="API/qalgebra.pattern_matching.html#qalgebra.pattern_matching.ProtoExpr" title="qalgebra.pattern_matching.ProtoExpr"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProtoExpressions</span></code></a>), the patterns in the <code class="docutils literal notranslate"><span class="pre">_rules</span></code>
and <code class="docutils literal notranslate"><span class="pre">_binary_rules</span></code> class attributes are always constructed using the
<a class="reference internal" href="API/qalgebra.pattern_matching.html#qalgebra.pattern_matching.pattern_head" title="qalgebra.pattern_matching.pattern_head"><code class="xref py py-func docutils literal notranslate"><span class="pre">pattern_head()</span></code></a> helper function. In contrast, patterns for
<a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression.apply_rules" title="qalgebra.core.abstract_algebra.Expression.apply_rules"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Expression.apply_rules()</span></code></a> are usually created through the
<a class="reference internal" href="API/qalgebra.pattern_matching.html#qalgebra.pattern_matching.pattern" title="qalgebra.pattern_matching.pattern"><code class="xref py py-func docutils literal notranslate"><span class="pre">pattern()</span></code></a> helper function. The <a class="reference internal" href="API/qalgebra.pattern_matching.html#qalgebra.pattern_matching.wc" title="qalgebra.pattern_matching.wc"><code class="xref py py-func docutils literal notranslate"><span class="pre">wc()</span></code></a> function is used to associate
Expression arguments with wildcard names.</p>
</div>
<div class="section" id="algebraic-manipulations">
<span id="hilbert-space-algebra"></span><h3>Algebraic Manipulations<a class="headerlink" href="#algebraic-manipulations" title="Permalink to this headline">¬∂</a></h3>
<p>While QAlgebra automatically applies a large number of rules and simplifications if
expressions are instantiated through the <a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.Expression.create" title="qalgebra.core.abstract_algebra.Expression.create"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create()</span></code></a> method,
significant value is placed on manually manipulating algebraic expressions. In
fact, this is one of the design considerations that separates it from the
<a class="reference external" href="http://www.sympy.org/en/index.html">Sympy</a> package: The rule-based transformations are both explicit and
optional, allowing to instantiate expressions exactly in the desired form, and
to apply specifc manipulations. Unlink in <a class="reference external" href="http://www.sympy.org/en/index.html">Sympy</a>, the (tex) form of an
expressions will directly reflect the structure of the expression, and the
ordering of terms can be configured by the user. Thus, a
<a class="reference external" href="http://jupyter.org">Jupyter Notebook</a> could document a symbolic derivation in the exact form one
would normally write that derivation out by hand.</p>
<p>Common maniupulations and symbolic algorithms are collected in
<a class="reference internal" href="API/qalgebra.toolbox.html#module-qalgebra.toolbox" title="qalgebra.toolbox"><code class="xref py py-mod docutils literal notranslate"><span class="pre">qalgebra.toolbox</span></code></a>.</p>
</div>
</div>
<div class="section" id="id2">
<h2>Hilbert Space Algebra<a class="headerlink" href="#id2" title="Permalink to this headline">¬∂</a></h2>
<p>The <a class="reference internal" href="API/qalgebra.core.hilbert_space_algebra.html#module-qalgebra.core.hilbert_space_algebra" title="qalgebra.core.hilbert_space_algebra"><code class="xref py py-mod docutils literal notranslate"><span class="pre">hilbert_space_algebra</span></code></a> module defines a simple algebra
of finite dimensional or countably infinite dimensional Hilbert spaces.</p>
<div class="graphviz"><p><a href="_images/inheritance-a1391291d989c5347433e29ab5598700d142d9a1.svg"><i class="fa fa-external-link" aria-hidden="true"></i> SVG</a></p><object data="_images/inheritance-a1391291d989c5347433e29ab5598700d142d9a1.svg" type="image/svg+xml" class="inheritance">
<p class="warning">Inheritance diagram of qalgebra.core.hilbert_space_algebra</p></object></div>
<p>Local/primitive degrees of freedom (e.g. a single multi-level atom or a cavity
mode) are described by a <a class="reference internal" href="API/qalgebra.core.hilbert_space_algebra.html#qalgebra.core.hilbert_space_algebra.LocalSpace" title="qalgebra.core.hilbert_space_algebra.LocalSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalSpace</span></code></a>; it requires a label, and may
define a basis through the <cite>basis</cite> or <cite>dimension</cite> arguments. The <a class="reference internal" href="API/qalgebra.core.hilbert_space_algebra.html#qalgebra.core.hilbert_space_algebra.LocalSpace" title="qalgebra.core.hilbert_space_algebra.LocalSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalSpace</span></code></a>
may also define custom identifiers for operators acting on that space
(subclasses of <a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.LocalOperator" title="qalgebra.core.operator_algebra.LocalOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalOperator</span></code></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Destroy</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascii</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&#39;a^(1)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hs1_custom</span> <span class="o">=</span> <span class="n">LocalSpace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">local_identifiers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Destroy&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Destroy</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="n">hs1_custom</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascii</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">&#39;b^(1)&#39;</span>
</pre></div>
</div>
<p>Instances of <a class="reference internal" href="API/qalgebra.core.hilbert_space_algebra.html#qalgebra.core.hilbert_space_algebra.LocalSpace" title="qalgebra.core.hilbert_space_algebra.LocalSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalSpace</span></code></a> combine via a product into
composite tensor product spaces are given by instances of the <a class="reference internal" href="API/qalgebra.core.hilbert_space_algebra.html#qalgebra.core.hilbert_space_algebra.ProductSpace" title="qalgebra.core.hilbert_space_algebra.ProductSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProductSpace</span></code></a></p>
<p>Furthermore,</p>
<ul class="simple">
<li><p>the <a class="reference internal" href="API/qalgebra.core.hilbert_space_algebra.html#qalgebra.core.hilbert_space_algebra.TrivialSpace" title="qalgebra.core.hilbert_space_algebra.TrivialSpace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrivialSpace</span></code></a> represents a
<em>trivial</em> <a class="footnote-reference brackets" href="#f1" id="id3">1</a> Hilbert space <span class="math notranslate nohighlight">\(\mathcal{H}_0 \simeq \mathbb{C}\)</span></p></li>
<li><p>the <a class="reference internal" href="API/qalgebra.core.hilbert_space_algebra.html#qalgebra.core.hilbert_space_algebra.FullSpace" title="qalgebra.core.hilbert_space_algebra.FullSpace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FullSpace</span></code></a> represents a
Hilbert space that includes all possible degrees of freedom.</p></li>
</ul>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id3">1</a></span></dt>
<dd><p><em>trivial</em> in the sense that <span class="math notranslate nohighlight">\(\mathcal{H}_0 \simeq \mathbb{C}\)</span>,
i.e., all states are multiples of each other and thus equivalent.</p>
</dd>
</dl>
<p>Expressions in the operator, state, and superoperator algebra (discussed below)
will all be associated with a Hilbert space. If any expressions are intended to
be fed into a numerical simulation, all their associated Hilbert spaces must
have a known dimension.  Since all expressions are immutable, it is important
to either define the all the <a class="reference internal" href="API/qalgebra.core.hilbert_space_algebra.html#qalgebra.core.hilbert_space_algebra.LocalSpace" title="qalgebra.core.hilbert_space_algebra.LocalSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalSpace</span></code></a> instances they depend on with
<cite>basis</cite> or <cite>dimension</cite> arguments first, or to later generate new expression
with updated Hilbert spaces through the
<a class="reference internal" href="API/qalgebra.core.abstract_algebra.html#qalgebra.core.abstract_algebra.substitute" title="qalgebra.core.abstract_algebra.substitute"><code class="xref py py-func docutils literal notranslate"><span class="pre">substitute()</span></code></a> routine.</p>
</div>
<div class="section" id="operator-algebra">
<span id="id4"></span><h2>Operator Algebra<a class="headerlink" href="#operator-algebra" title="Permalink to this headline">¬∂</a></h2>
<p>The <a class="reference internal" href="API/qalgebra.core.operator_algebra.html#module-qalgebra.core.operator_algebra" title="qalgebra.core.operator_algebra"><code class="xref py py-mod docutils literal notranslate"><span class="pre">operator_algebra</span></code></a> module implements and algebra of Hilbert space operators</p>
<div class="graphviz"><p><a href="_images/inheritance-f2852f54348f2461c573da7b99faf15d49cf37a7.svg"><i class="fa fa-external-link" aria-hidden="true"></i> SVG</a></p><object data="_images/inheritance-f2852f54348f2461c573da7b99faf15d49cf37a7.svg" type="image/svg+xml" class="inheritance">
<p class="warning">Inheritance diagram of qalgebra.core.operator_algebra</p></object></div>
<p>Operator expressions are constructed from sums (<a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.OperatorPlus" title="qalgebra.core.operator_algebra.OperatorPlus"><code class="xref py py-class docutils literal notranslate"><span class="pre">OperatorPlus</span></code></a>) and
products (<a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.OperatorTimes" title="qalgebra.core.operator_algebra.OperatorTimes"><code class="xref py py-class docutils literal notranslate"><span class="pre">OperatorTimes</span></code></a>) of some basic elements, most importantly <em>local</em>
operators (subclasses of <a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.LocalOperator" title="qalgebra.core.operator_algebra.LocalOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalOperator</span></code></a>). This include some very common symbolic operator such as</p>
<ul class="simple">
<li><p>Harmonic oscillator mode operators <span class="math notranslate nohighlight">\(a_s, a_s^\dagger\)</span>: <a class="reference internal" href="API/qalgebra.library.fock_operators.html#qalgebra.library.fock_operators.Destroy" title="qalgebra.library.fock_operators.Destroy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Destroy</span></code></a>, <a class="reference internal" href="API/qalgebra.library.fock_operators.html#qalgebra.library.fock_operators.Create" title="qalgebra.library.fock_operators.Create"><code class="xref py py-class docutils literal notranslate"><span class="pre">Create</span></code></a></p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span>-switching operators  <span class="math notranslate nohighlight">\(\sigma_{jk}^s := \left| j \right\rangle_s \left \langle k \right|_s\)</span>: <a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.LocalSigma" title="qalgebra.core.operator_algebra.LocalSigma"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalSigma</span></code></a></p></li>
<li><p>coherent displacement operators <span class="math notranslate nohighlight">\(D_s(\alpha) := \exp{\left(\alpha a_s^\dagger - \alpha^* a_s\right)}\)</span>: <a class="reference internal" href="API/qalgebra.library.fock_operators.html#qalgebra.library.fock_operators.Displace" title="qalgebra.library.fock_operators.Displace"><code class="xref py py-class docutils literal notranslate"><span class="pre">Displace</span></code></a></p></li>
<li><p>phase operators <span class="math notranslate nohighlight">\(P_s(\phi) := \exp {\left(i\phi a_s^\dagger a_s\right)}\)</span>: <a class="reference internal" href="API/qalgebra.library.fock_operators.html#qalgebra.library.fock_operators.Phase" title="qalgebra.library.fock_operators.Phase"><code class="xref py py-class docutils literal notranslate"><span class="pre">Phase</span></code></a></p></li>
<li><p>squeezing operators <span class="math notranslate nohighlight">\(S_s(\eta) := \exp {\left[{1\over 2}\left({\eta {a_s^\dagger}^2 - \eta^* a_s^2}\right)\right]}\)</span>: <a class="reference internal" href="API/qalgebra.library.fock_operators.html#qalgebra.library.fock_operators.Squeeze" title="qalgebra.library.fock_operators.Squeeze"><code class="xref py py-class docutils literal notranslate"><span class="pre">Squeeze</span></code></a></p></li>
</ul>
<p>Furthermore, there exist symbolic representations for constants and symbols:</p>
<ul class="simple">
<li><p>the <a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.IdentityOperator" title="qalgebra.core.operator_algebra.IdentityOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">IdentityOperator</span></code></a></p></li>
<li><p>the <a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.ZeroOperator" title="qalgebra.core.operator_algebra.ZeroOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ZeroOperator</span></code></a></p></li>
<li><p>an arbitrary <a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.OperatorSymbol" title="qalgebra.core.operator_algebra.OperatorSymbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">OperatorSymbol</span></code></a></p></li>
</ul>
<p>There are also a number of algebraic operations that act only on a single operator as their only operand. These include:</p>
<ul class="simple">
<li><p>the Hilbert space <a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.Adjoint" title="qalgebra.core.operator_algebra.Adjoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">Adjoint</span></code></a> operator <span class="math notranslate nohighlight">\(X^\dagger\)</span></p></li>
<li><p><a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.PseudoInverse" title="qalgebra.core.operator_algebra.PseudoInverse"><code class="xref py py-class docutils literal notranslate"><span class="pre">PseudoInverse</span></code></a> of operators <span class="math notranslate nohighlight">\(X^+\)</span> satisfying <span class="math notranslate nohighlight">\(X X^+ X = X\)</span> and <span class="math notranslate nohighlight">\(X^+ X X^+ = X^+\)</span> as well as <span class="math notranslate nohighlight">\((X^+ X)^\dagger = X^+ X\)</span> and <span class="math notranslate nohighlight">\((X X^+)^\dagger = X X^+\)</span></p></li>
<li><p>the kernel projection operator (<a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.NullSpaceProjector" title="qalgebra.core.operator_algebra.NullSpaceProjector"><code class="xref py py-class docutils literal notranslate"><span class="pre">NullSpaceProjector</span></code></a>) <span class="math notranslate nohighlight">\(\mathcal{P}_{{\rm Ker} X}\)</span> satisfying both <span class="math notranslate nohighlight">\(X \mathcal{P}_{{\rm Ker} X} = 0\)</span> and <span class="math notranslate nohighlight">\(X^+ X =  1 - \mathcal{P}_{{\rm Ker} X}\)</span></p></li>
<li><p>Partial traces over Operators <span class="math notranslate nohighlight">\({\rm Tr}_s X\)</span>: <a class="reference internal" href="API/qalgebra.core.operator_algebra.html#qalgebra.core.operator_algebra.OperatorTrace" title="qalgebra.core.operator_algebra.OperatorTrace"><code class="xref py py-class docutils literal notranslate"><span class="pre">OperatorTrace</span></code></a></p></li>
</ul>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¬∂</a></h3>
<p>Say we want to write a function that constructs a typical Jaynes-Cummings Hamiltonian</p>
<div class="math notranslate nohighlight">
\[H = \Delta \sigma^\dagger \sigma + \Theta a^\dagger a +
     i g(\sigma a^\dagger - \sigma^\dagger a) + i\epsilon (a - a^\dagger)\]</div>
<p>for a given set of numerical parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">I</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">H_JC</span><span class="p">(</span><span class="n">Delta</span><span class="p">,</span> <span class="n">Theta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># create Fock- and Atom local spaces</span>
<span class="gp">... </span>    <span class="n">fock</span> <span class="o">=</span> <span class="n">LocalSpace</span><span class="p">(</span><span class="s1">&#39;fock&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">tls</span> <span class="o">=</span> <span class="n">LocalSpace</span><span class="p">(</span><span class="s1">&#39;tls&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># create representations of a and sigma</span>
<span class="gp">... </span>    <span class="n">a</span> <span class="o">=</span> <span class="n">Destroy</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="n">fock</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">sigma</span> <span class="o">=</span> <span class="n">LocalSigma</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="n">hs</span><span class="o">=</span><span class="n">tls</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">H</span> <span class="o">=</span> <span class="p">(</span><span class="n">Delta</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">sigma</span>                    <span class="c1"># detuning from atomic resonance</span>
<span class="gp">... </span>        <span class="o">+</span> <span class="n">Theta</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">a</span>                           <span class="c1"># detuning from cavity resonance</span>
<span class="gp">... </span>        <span class="o">+</span> <span class="n">I</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="p">(</span><span class="n">sigma</span> <span class="o">*</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">-</span> <span class="n">sigma</span><span class="o">.</span><span class="n">dag</span><span class="p">()</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>   <span class="c1"># atom-mode coupling, I = sqrt(-1)</span>
<span class="gp">... </span>        <span class="o">+</span> <span class="n">I</span> <span class="o">*</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">a</span><span class="o">.</span><span class="n">dag</span><span class="p">()))</span>                  <span class="c1"># external driving amplitude</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">H</span>
</pre></div>
</div>
<p>Here we have allowed for a variable namespace which would come in handy if we wanted to construct an overall model that features multiple Jaynes-Cummings-type subsystems.</p>
<p>By using the support for symbolic <a class="reference external" href="https://docs.sympy.org/latest/modules/index.html#module-sympy" title="(in SymPy v1.6.2)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sympy</span></code></a> expressions as scalar pre-factors to operators, one can instantiate a Jaynes-Cummings Hamiltonian with symbolic parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Delta</span><span class="p">,</span> <span class="n">Theta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;Delta, Theta, epsilon, g&#39;</span><span class="p">,</span> <span class="n">real</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span> <span class="o">=</span> <span class="n">H_JC</span><span class="p">(</span><span class="n">Delta</span><span class="p">,</span> <span class="n">Theta</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span>
<span class="go">‚Öà Œµ (-aÃÇ^(fock)‚Ä† + aÃÇ‚ÅΩ·∂†·µí·∂ú·µè‚Åæ) + Œò aÃÇ^(fock)‚Ä† aÃÇ‚ÅΩ·∂†·µí·∂ú·µè‚Åæ + ‚Öà g (aÃÇ^(fock)‚Ä† |g‚ü©‚ü®e|‚ÅΩ·µóÀ°À¢‚Åæ - aÃÇ‚ÅΩ·∂†·µí·∂ú·µè‚Åæ |e‚ü©‚ü®g|‚ÅΩ·µóÀ°À¢‚Åæ) + Œî |e‚ü©‚ü®e|‚ÅΩ·µóÀ°À¢‚Åæ</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">H</span><span class="o">.</span><span class="n">space</span>
<span class="go">‚Ñå_fock ‚äó ‚Ñå_tls</span>
</pre></div>
</div>
<p>Operator products between commuting operators are automatically re-arranged such that they are ordered according to their Hilbert Space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Create</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Create</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">aÃÇ^(1)‚Ä† aÃÇ^(2)‚Ä†</span>
</pre></div>
</div>
<p>There are quite a few built-in replacement rules, e.g., mode operators products are normally ordered:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Destroy</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Create</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">ùüô + aÃÇ^(1)‚Ä† aÃÇ‚ÅΩ¬π‚Åæ</span>
</pre></div>
</div>
<p>Or for higher powers one can use the <code class="docutils literal notranslate"><span class="pre">expand()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">Destroy</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Destroy</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Destroy</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Create</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Create</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">Create</span><span class="p">(</span><span class="n">hs</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">6 + aÃÇ^(1)‚Ä† aÃÇ^(1)‚Ä† aÃÇ^(1)‚Ä† aÃÇ‚ÅΩ¬π‚Åæ aÃÇ‚ÅΩ¬π‚Åæ aÃÇ‚ÅΩ¬π‚Åæ + 9 aÃÇ^(1)‚Ä† aÃÇ^(1)‚Ä† aÃÇ‚ÅΩ¬π‚Åæ aÃÇ‚ÅΩ¬π‚Åæ + 18 aÃÇ^(1)‚Ä† aÃÇ‚ÅΩ¬π‚Åæ</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="state-ket-algebra">
<span id="state-algebra"></span><h2>State (Ket-) Algebra<a class="headerlink" href="#state-ket-algebra" title="Permalink to this headline">¬∂</a></h2>
<p>The <a class="reference internal" href="API/qalgebra.core.state_algebra.html#module-qalgebra.core.state_algebra" title="qalgebra.core.state_algebra"><code class="xref py py-mod docutils literal notranslate"><span class="pre">state_algebra</span></code></a> module implements an algebra of Hilbert space states.</p>
<div class="graphviz"><p><a href="_images/inheritance-0cdc9db622c70132784e2858b9d0ee2f6cd32e3a.svg"><i class="fa fa-external-link" aria-hidden="true"></i> SVG</a></p><object data="_images/inheritance-0cdc9db622c70132784e2858b9d0ee2f6cd32e3a.svg" type="image/svg+xml" class="inheritance">
<p class="warning">Inheritance diagram of qalgebra.core.state_algebra</p></object></div>
<p>By default we represent states <span class="math notranslate nohighlight">\(\psi\)</span> as ket vectors <span class="math notranslate nohighlight">\(\psi \to | \psi \rangle\)</span>.
However, any state can also be represented in its adjoint bra form, since those representations are dual:</p>
<div class="math notranslate nohighlight">
\[\psi \leftrightarrow | \psi \rangle \leftrightarrow \langle \psi |\]</div>
<p>States can be added to states of the same Hilbert space. They can be multiplied by:</p>
<ul class="simple">
<li><p>scalars, to just yield a rescaled state within the original space, resulting in <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.ScalarTimesKet" title="qalgebra.core.state_algebra.ScalarTimesKet"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarTimesKet</span></code></a></p></li>
<li><p>operators that act on some of the states degrees of freedom (but none that aren‚Äôt part of the state‚Äôs Hilbert space), resulting in a <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.OperatorTimesKet" title="qalgebra.core.state_algebra.OperatorTimesKet"><code class="xref py py-class docutils literal notranslate"><span class="pre">OperatorTimesKet</span></code></a></p></li>
<li><p>other states that have a Hilbert space corresponding to a disjoint set of degrees of freedom, resulting in a <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.TensorKet" title="qalgebra.core.state_algebra.TensorKet"><code class="xref py py-class docutils literal notranslate"><span class="pre">TensorKet</span></code></a></p></li>
</ul>
<p>Furthermore,</p>
<ul class="simple">
<li><p>a ket object can multiply a <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.Bra" title="qalgebra.core.state_algebra.Bra"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bra</span></code></a> of the same space from the left to yield a <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.KetBra" title="qalgebra.core.state_algebra.KetBra"><code class="xref py py-class docutils literal notranslate"><span class="pre">KetBra</span></code></a> operator.</p></li>
</ul>
<p>And conversely,</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.Bra" title="qalgebra.core.state_algebra.Bra"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bra</span></code></a> can multiply a ket from the left to create a (partial) inner product object <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.BraKet" title="qalgebra.core.state_algebra.BraKet"><code class="xref py py-class docutils literal notranslate"><span class="pre">BraKet</span></code></a>.
Currently, only full inner products are supported, i.e. the ket and <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.Bra" title="qalgebra.core.state_algebra.Bra"><code class="xref py py-class docutils literal notranslate"><span class="pre">Bra</span></code></a> operands need to have the same space.</p></li>
</ul>
<p>There are also the following symbolic states:</p>
<ul class="simple">
<li><p>arbitrary <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.KetSymbol" title="qalgebra.core.state_algebra.KetSymbol"><code class="xref py py-class docutils literal notranslate"><span class="pre">KetSymbols</span></code></a></p></li>
<li><p>the <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.TrivialKet" title="qalgebra.core.state_algebra.TrivialKet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrivialKet</span></code></a> acting as the identity, and</p></li>
<li><p>the <a class="reference internal" href="API/qalgebra.core.state_algebra.html#qalgebra.core.state_algebra.ZeroKet" title="qalgebra.core.state_algebra.ZeroKet"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ZeroKet</span></code></a>.</p></li>
</ul>
</div>
<div class="section" id="super-operator-algebra">
<span id="id5"></span><h2>Super-Operator Algebra<a class="headerlink" href="#super-operator-algebra" title="Permalink to this headline">¬∂</a></h2>
<p>The <a class="reference internal" href="API/qalgebra.core.super_operator_algebra.html#module-qalgebra.core.super_operator_algebra" title="qalgebra.core.super_operator_algebra"><code class="xref py py-mod docutils literal notranslate"><span class="pre">super_operator_algebra</span></code></a> contains an implementation of a
superoperator algebra, i.e., operators acting on Hilbert space operator or
elements of Liouville space (density matrices).</p>
<div class="graphviz"><p><a href="_images/inheritance-798fd2324d77c08896bad7150f579999e2dd3809.svg"><i class="fa fa-external-link" aria-hidden="true"></i> SVG</a></p><object data="_images/inheritance-798fd2324d77c08896bad7150f579999e2dd3809.svg" type="image/svg+xml" class="inheritance">
<p class="warning">Inheritance diagram of qalgebra.core.super_operator_algebra</p></object></div>
<p>Each super-operator has an associated <cite>space</cite> property which gives the Hilbert space
on which the operators the super-operator acts non-trivially are themselves acting non-trivially.</p>
<p>The most basic way to construct super-operators is by lifting ‚Äònormal‚Äô operators to linear pre- and post-multiplication super-operators:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">OperatorSymbol</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">hs</span><span class="o">=</span><span class="n">FullSpace</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SPre</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span>
<span class="go">AÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ BÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SPost</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">*</span> <span class="n">B</span>
<span class="go">BÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ CÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">SPre</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">*</span> <span class="n">SPost</span><span class="p">(</span><span class="n">C</span><span class="p">))</span> <span class="o">*</span> <span class="n">B</span>
<span class="go">AÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ BÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ CÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">SPre</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">-</span> <span class="n">SPost</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="o">*</span> <span class="n">B</span>        <span class="c1"># Linear super-operator associated with A that maps B --&gt; [A,B]</span>
<span class="go">AÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ BÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ - BÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ AÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ</span>
</pre></div>
</div>
<p>The neutral elements of super-operator addition and multiplication are <a class="reference internal" href="API/qalgebra.core.super_operator_algebra.html#qalgebra.core.super_operator_algebra.ZeroSuperOperator" title="qalgebra.core.super_operator_algebra.ZeroSuperOperator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ZeroSuperOperator</span></code></a> and <a class="reference internal" href="API/qalgebra.core.super_operator_algebra.html#qalgebra.core.super_operator_algebra.IdentitySuperOperator" title="qalgebra.core.super_operator_algebra.IdentitySuperOperator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IdentitySuperOperator</span></code></a>, respectively.</p>
<p>Super operator objects can be added together in code via the infix ‚Äò+‚Äô operator and multiplied with the infix ‚Äò*‚Äô operator.
They can also be added to or multiplied by scalar objects.
In the first case, the scalar object is multiplied by the <a class="reference internal" href="API/qalgebra.core.super_operator_algebra.html#qalgebra.core.super_operator_algebra.IdentitySuperOperator" title="qalgebra.core.super_operator_algebra.IdentitySuperOperator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IdentitySuperOperator</span></code></a> constant.</p>
<p>Super operators are applied to operators by multiplying an operator with superoperator from the left:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">=</span> <span class="n">SuperOperatorSymbol</span><span class="p">(</span><span class="s2">&quot;S&quot;</span><span class="p">,</span> <span class="n">hs</span><span class="o">=</span><span class="n">FullSpace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">OperatorSymbol</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">hs</span><span class="o">=</span><span class="n">FullSpace</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">S</span> <span class="o">*</span> <span class="n">A</span>
<span class="go">S‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ[AÃÇ‚ÅΩ·µó·µí·µó·µÉÀ°‚Åæ]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">S</span><span class="o">*</span><span class="n">A</span><span class="p">,</span> <span class="n">Operator</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The result is an operator.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="printing.html" class="btn btn-neutral float-right" title="The Printing System" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="readme.html" class="btn btn-neutral float-left" title="QAlgebra" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Michael Goerz
      <span class="lastupdated">
        Last updated on Nov 25, 2020.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>